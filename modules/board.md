# uAPI модуля «Доска объявлений»

- [Материалы](#module-board-entry)
- [Категории / Разделы](#module-board-category)
- [Фильтры](#module-board-filter)
- [Комментарии](#module-board-comments)
- [Настройки полей](#module-board-fields)

<a name="module-board-entry"></a>
### Материалы

#### [GET] Все материалы модуля

Особенности:

1. Сколько материалов будет выдано за запрос – зависит от настроек модуля (Панель управления -> Доска объявлений -> Настройки модуля -> Количество материалов на главной странице).

> Обязательные параметры: отсутствуют

Пример запроса:

    $response = $request->get('/board', array(
        // без параметров
    ));

Пример ответа:

    {
       "ads":[
          {
             "other3":"",
             "reads":0,
             "other5":"",
             "comments_url":"http://yoursite.ucoz.ru/board/kategorija_1/nazvanie_materiala/1-1-0-7#comments",
             "other1":"",
             "loads":0,
             "rate_num":0,
             "author_email":"Email автора",
             "author":"Имя автора",
             "comments":"yes",
             "rating":"0.00",
             "add_date":"2015-01-15 01:56",
             "rate_sum":0,
             "category":{
                "access2upload":[
                   "Все группы"
                ],
                "url":"http://yoursite.ucoz.ru/board/kategorija_1/1",
                "access2add":[
                   "Все группы"
                ],
                "name":"Категория 1",
                "access2category":[
                   "Все группы"
                ],
                "id":1,
                "description":""
             },
             "id":7,
             "ontop":"no",
             "other4":"",
             "author_site":"http://Веб-сайт автора",
             "subscribe":"no",
             "other2":"",
             "pending":"no",
             "phone":"",
             "description_type=bb":"Краткое описание материала",
             "message_type=html":"Полное описание материала",
             "entry_url":"http://yoursite.ucoz.ru/board/kategorija_1/nazvanie_materiala/1-1-0-7",
             "who_add":"Dmitry",
             "sort":0,
             "comments_num":0,
             "title":"Название материала",
             "hgu_title":"nazvanie_materiala"
          },
          {
              //информация о материале, например, ID2
          },
           {
               //информация о материале, например, ID3
          }
       ],
       "page":1,
       "total_ads":1,
       "pages":"1",
       "per_page":"10"
    }

Расшифровка переменных:

- `ads` – [Массив] – **Информация о запрошенном материале**
    - `other3` – [Строка] – Значение поля «Дополнительное поле 3»
    - `reads` – [Число] – Количество просмотров материала
    - `other5` – [Строка] – Значение поля «Дополнительное поле 5»
    - `comments_url` – [Строка] – Ссылка на страницу материала с комментариями
    - `other1` – [Строка] – Значение поля «Дополнительное поле 1»
    - `rate_num` – [Число] – Количество голосов (рейтинг)
    - `author_email` – [Строка] – Email автора материала
    - `author` – [Строка] – Полное имя автора материала
    - `comments` – [Строка] – Позволить оставлять комментарии? (`yes`/`no`)
    - `rating` – [Число] – Рейтинг материала (Общая сумма рейтинга/на количество голосов)
    - `add_date` – [Строка] – Время добавления материала
    - `rate_sum` – [Число] – Общая сумма рейтинга
    - `categories` – [Массив] – **О категории материала**
        - `access2upload` – Группы, имеющие возможность скачивать файлы
        - `url` – [Строка] – Ссылка на категорию материала
        - `access2add` – [Массив] – Права на добавление материалов в категорию
        - `name` – [Строка] – Название категории материала
        - `access2category` – [Массив] – Право на просмотр категории материала
        - `id` – [Число] – ID категории материала
        - `description` – [Строка] – Описание категории материала
    - `id` – [Число] – ID полученного материала
    - `ontop` – [Строка] – Показывать материал всегда сверху? (`yes`/`no`)
    - `author_site` – [Строка] – Ссылка на сайт автора
    - `subscribe` – [Строка] – Включена ли подписка на комментарии (уведомления) (`yes`/`no`)
    - `other2` – [Строка] – Значение поля «Дополнительное поле 2»
    - `pending` – [Строка] – В ожидани ли активации материал? (`yes`/`no`)
    - `phone` – [Строка] – Значение поля «Телефон автора»
    - `description_type=(html|bb|plain)` – [Строка] – Краткое описание материала
    - `message_type=(html|bb|plain)` – [Строка] – Полное описание материала
    - `entry_url` – [Строка] – Полная ссылка на материал
    - `who_add` – [Строка] – Никнейм пользователя, добавивший материал
    - `sort` –
    - `comments_num` – [Число] – Количество добавленных комментариев к материалу
    - `title` – [Строка] – Название материала
    - `hgu_title` – [Строка] – ЧПУ материала
- `page` – [Число] – Количество страниц комментариев
- `total_ads` – [Число] – общее кол-во материалов в модуле
- `pages_list` – [Массив] – Возможные страницы в переключателе комментариев
- `per_page` – [Число] – Количество комментариев на 1 страницу

#### [GET] определенный материал

> Обязательные параметры: `id` материала

Пример запроса:

    $response = $request->get('/board', array(
        'id' => 'АЙДИМАТЕРИАЛА'
    ));

Особенности:

1. В переменных `description` и `message` переносы строк автоматически меняются на `\n` (в случае, если перенос строки был сделан без html-тега `<br />`)
1. В переменных `description` и `message` если там есть html-тег переноса `<br />` – будет осуществлен и визуальный перенос строки, без вывода `<br />` (то есть html-тег воспроизведется)
1. Переменные `access2category` и `access2add` могут иметь другой вид, если права установлены для всех групп пользователей
1. Если у материала категория входит в раздел – то раздел никак не будет получен в GET-запросе
1. Если материал входит в более 1 категории, то о каждой категории, в которые входит материал, будет показана информация в GET-запросе

Пример ответа:

    {
       "ads":[
          {
             "other3":"",
              "files":[
                  {
                     "small":"http://yoursite.ucoz.ru/_sf/0/s57172723.jpg",
                     "full_height":1200,
                     "full_width":1000,
                     "small_height":150,
                     "small_width":125,
                     "full":"http://yoursite.ucoz.ru/_sf/0/57172723.jpg"
                  }
               ],
             "reads":0,
             "other5":"",
             "comments_url":"http://yoursite.ucoz.ru/board/kategorija_1/nazvanie_materiala/1-1-0-7#comments",
             "other1":"",
             "loads":0,
             "rate_num":0,
             "author_email":"Email автора",
             "author":"Имя автора",
             "comments":"yes",
             "rating":"0.00",
             "add_date":"2015-01-15 01:56",
             "rate_sum":0,
             "category":{
                "access2upload":[
                   "Все группы"
                ],
                "url":"http://yoursite.ucoz.ru/board/kategorija_1/1",
                "access2add":[
                   "Все группы"
                ],
                "name":"Категория 1",
                "access2category":[
                   "Все группы"
                ],
                "id":1,
                "description":""
             },
             "id":7,
             "ontop":"no",
             "other4":"",
             "author_site":"http://Веб-сайт автора",
             "subscribe":"no",
             "other2":"",
             "pending":"no",
             "phone":"",
             "description_type=bb":"Краткое описание материала",
             "message_type=html":"Полное описание материала",
             "entry_url":"http://yoursite.ucoz.ru/board/kategorija_1/nazvanie_materiala/1-1-0-7",
             "who_add":"Dmitry",
             "sort":0,
             "comments_num":0,
             "title":"Название материала",
             "hgu_title":"nazvanie_materiala"
          }
       ]
    }

    // для особенности 3
    "access2add": [
        "Все группы"
    ],

    // для особенности 3
    "access2category": [
        "Все группы"
    ],

Расшифровка переменных:

- `ads` – [Массив] – **Информация о запрошенном материале**
    - `other3` – [Строка] – Значение поля «Дополнительное поле 3»
    - `reads` – [Число] – Количество просмотров материала
    - `other5` – [Строка] – Значение поля «Дополнительное поле 5»
    - `comments_url` – [Строка] – Ссылка на страницу материала с комментариями
    - `other1` – [Строка] – Значение поля «Дополнительное поле 1»
    - `rate_num` – [Число] – Количество голосов (рейтинг)
    - `author_email` – [Строка] – Email автора материала
    - `author` – [Строка] – Полное имя автора материала
    - `comments` – [Строка] – Позволить оставлять комментарии? (`yes`/`no`)
    - `rating` – [Число] – Рейтинг материала (Общая сумма рейтинга/на количество голосов)
    - `add_date` – [Строка] – Время добавления материала
    - `rate_sum` – [Число] – Общая сумма рейтинга
    - `categories` – [Массив] – О категории материала
        - `access2upload` – Группы, имеющие возможность скачивать файлы
        - `url` – [Строка] – Ссылка на категорию материала
        - `access2add` – [Массив] – Права на добавление материалов в категорию
        - `name` – [Строка] – Название категории материала
        - `access2category` – [Массив] – Право на просмотр категории материала
        - `id` – [Число] – ID категории материала
        - `description` – [Строка] – Описание категории материала
    - `id` – [Число] – ID полученного материала
    - `ontop` – [Строка] – Показывать материал всегда сверху? (`yes`/`no`)
    - `author_site` – [Строка] – Ссылка на сайт автора
    - `subscribe` – [Строка] – Включена ли подписка на комментарии (уведомления) (`yes`/`no`)
    - `other2` – [Строка] – Значение поля «Дополнительное поле 2»
    - `pending` – [Строка] – В ожидани ли активации материал? (`yes`/`no`)
    - `phone` – [Строка] – Значение поля «Телефон автора»
    - `description_type=(html|bb|plain)` – [Строка] – Краткое описание материала
    - `message_type=(html|bb|plain)` – [Строка] – Полное описание материала
    - `entry_url` – [Строка] – Полная ссылка на материал
    - `who_add` – [Строка] – Никнейм пользователя, добавивший материал
    - `sort` –
    - `comments_num` – [Число] – Количество добавленных комментариев к материалу
    - `title` – [Строка] – Название материала
    - `hgu_title` – [Строка] – ЧПУ материала

#### [GET] из определенной категории

> Обязательные параметры: `id` категории

Особенности:

1. Чтобы получить данные материалов со страницы 2, достаточно добавить к URL параметр `&page=N` (где `N` – номер страницы)
1. Сколько материалов будет выдано за запрос – зависит от настроек модуля (Панель управления -> Онлайн игры -> Настройки модуля -> Количество материалов на странице в разделе).

Пример запроса:

    $response = $request->get('/board', array(
        'category' => 'АЙДИМКАТЕГОРИИ'
    ));

    $response = $request->get('/board', array(
        'category' => 'АЙДИМКАТЕГОРИИ'
        'page' => '2'
    ));

Пример ответа:

    {
       "ads":[
          {
             "other3":"",
             "reads":0,
             "other5":"",
             "comments_url":"http://yoursite.ucoz.ru/board/kategorija_1/nazvanie_materiala/1-1-0-7#comments",
             "other1":"",
             "loads":0,
             "rate_num":0,
             "author_email":"Email автора",
             "author":"Имя автора",
             "comments":"yes",
             "rating":"0.00",
             "add_date":"2015-01-15 01:56",
             "rate_sum":0,
             "id":7,
             "ontop":"no",
             "other4":"",
             "author_site":"http://Веб-сайт автора",
             "subscribe":"no",
             "other2":"",
             "pending":"no",
             "description":"Краткое описание материала",
             "phone":"",
             "message":"Полное описание материала",
             "entry_url":"http://yoursite.ucoz.ru/board/kategorija_1/nazvanie_materiala/1-1-0-7",
             "who_add":"Dmitry",
             "sort":0,
             "comments_num":0,
             "title":"Название материала",
             "hgu_title":"nazvanie_materiala"
          },
          {
              //информация о материале, например, ID2
          },
           {
               //информация о материале, например, ID3
          }
       ],
       "page":1,
       "total_ads":1,
       "pages":"1",
       "per_page":"20",
       "category":{
          "access2upload":[
             "Все группы"
          ],
          "url":"http://yoursite.ucoz.ru/board/kategorija_1/1",
          "access2add":[
             "Все группы"
          ],
          "name":"Категория 1",
          "access2category":[
             "Все группы"
          ],
          "id":1,
          "description":""
       }
    }

Расшифровка переменных:

- `ads` – [Массив] – **Информация о запрошенном материале**
    - `other3` – [Строка] – Значение поля «Дополнительное поле 3»
    - `reads` – [Число] – Количество просмотров материала
    - `other5` – [Строка] – Значение поля «Дополнительное поле 5»
    - `comments_url` – [Строка] – Ссылка на страницу материала с комментариями
    - `other1` – [Строка] – Значение поля «Дополнительное поле 1»
    - `rate_num` – [Число] – Количество голосов (рейтинг)
    - `author_email` – [Строка] – Email автора материала
    - `author` – [Строка] – Полное имя автора материала
    - `comments` – [Строка] – Позволить оставлять комментарии? (`yes`/`no`)
    - `rating` – [Число] – Рейтинг материала (Общая сумма рейтинга/на количество голосов)
    - `add_date` – [Строка] – Время добавления материала
    - `rate_sum` – [Число] – Общая сумма рейтинга
    - `categories` – [Массив] – **О категории материала**
        - `access2upload` – Группы, имеющие возможность скачивать файлы
        - `url` – [Строка] – Ссылка на категорию материала
        - `access2add` – [Массив] – Права на добавление материалов в категорию
        - `name` – [Строка] – Название категории материала
        - `access2category` – [Массив] – Право на просмотр категории материала
        - `id` – [Число] – ID категории материала
        - `description` – [Строка] – Описание категории материала
    - `id` – [Число] – ID полученного материала
    - `ontop` – [Строка] – Показывать материал всегда сверху? (`yes`/`no`)
    - `author_site` – [Строка] – Ссылка на сайт автора
    - `subscribe` – [Строка] – Включена ли подписка на комментарии (уведомления) (`yes`/`no`)
    - `other2` – [Строка] – Значение поля «Дополнительное поле 2»
    - `pending` – [Строка] – В ожидани ли активации материал? (`yes`/`no`)
    - `phone` – [Строка] – Значение поля «Телефон автора»
    - `description_type=(html|bb|plain)` – [Строка] – Краткое описание материала
    - `message_type=(html|bb|plain)` – [Строка] – Полное описание материала
    - `entry_url` – [Строка] – Полная ссылка на материал
    - `who_add` – [Строка] – Никнейм пользователя, добавивший материал
    - `sort` –
    - `comments_num` – [Число] – Количество добавленных комментариев к материалу
    - `title` – [Строка] – Название материала
    - `hgu_title` – [Строка] – ЧПУ материала
- `page` – [Число] – Количество страниц комментариев
- `total_ads` – [Число] – общее кол-во материалов в модуле
- `pages_list` – [Массив] – Возможные страницы в переключателе комментариев
- `per_page` – [Число] – Количество комментариев на 1 страницу
    - `categories` – [Массив] – **О категории материала**
        - `access2upload` – Группы, имеющие возможность скачивать файлы
        - `url` – [Строка] – Ссылка на категорию материала
        - `access2add` – [Массив] – Права на добавление материалов в категорию
        - `name` – [Строка] – Название категории материала
        - `access2category` – [Массив] – Право на просмотр категории материала
        - `id` – [Число] – ID категории материала
        - `description` – [Строка] – Описание категории материала

#### [POST] Добавить материал

> Обязательные параметры: зависит от настроек модуля

Особенности:

1. HGU (ЧПУ) нельзя установить при добавлении материала
1. Все обязательные параметры исключительно определяются в Панели управления: Каталог статей – Настройки модуля. Но категория всегда является обязательной

Пример запроса:

    $response = $request->post('/board', array(
        'category' => '1',
        'title' => 'Название материала',
        'description_type=bb' => 'Краткое описание материала',
        'message_type=html' => 'Полное описание материала',
        'author_site' => 'Веб-сайт автора',
        'author_email' => 'Email автора',
        'author' => 'Имя автора',
        'link2source' => 'Источник материала',
        'file1' => '@dm.png'
    ));

Пример ответа:

    {
       "other3":null,
        "files":[
          {
             "small":"http://yoursite.ucoz.ru/_sf/0/s57172723.jpg",
             "full_height":1200,
             "full_width":1000,
             "small_height":150,
             "small_width":125,
             "full":"http://yoursite.ucoz.ru/_sf/0/57172723.jpg"
          }
       ],
       "end2br_msg":"no",
       "other5":null,
       "other1":null,
       "author_email":"Email автора",
       "author":"Имя автора",
       "filters":{
          "Тип объявления":[

          ]
       },
       "comments":"yes",
       "end2br_desc":"no",
       "ad_type":[
          null
       ],
       "category":{
          "access2upload":[
             "Все группы"
          ],
          "url":"http://yoursite.ucoz.ru/board/kategorija_1/1",
          "access2add":[
             "Все группы"
          ],
          "name":"Категория 1",
          "access2category":[
             "Все группы"
          ],
          "id":1,
          "description":""
       },
       "other4":null,
       "ontop":"no",
       "includehtml_desc":"no",
       "author_phone":null,
       "author_site":"http://Веб-сайт автора",
       "subscribe":"no",
       "other2":null,
       "pending":"no",
       "description_type=bb":"Краткое описание материала",
       "message_type=html":"Полное описание материала",
       "who_add":"Dmitry",
       "till_date":"1424385354",
       "sort":"",
       "title":"Название материала",
       "includehtml_msg":"no",
       "hgu_title":"nazvanie_materiala"
    }

Расшифровка переменных:


- `other3` – [Строка] – Значение поля «Дополнительное поле 3»
- `file1` – [Файл] – Изображение материала (в случае, если нужно несколько, то file2, file3)
- `end2br_msg` – [Строка] – Статус опции «Заменять теги переноса на `<br />`» для полного описания материала (`yes`/`no`)
- `other5` – [Строка] – Значение поля «Дополнительное поле 5»
- `other1` – [Строка] – Значение поля «Дополнительное поле 1»
- `author_email` – [Строка] – Email автора материала
- `name` – [Строка] – Поле "Контактное лицо",
- `filters` – [Массив] – В какие фильтры входит материал
- `comments` – [Строка] – Позволить оставлять комментарии? (`yes`/`no`)
- `end2br_desc` – [Строка] – Статус опции «Заменять теги переноса на `<br />`» для краткого описания материала (`yes`/`no`)
- `ad_type` – [Строка] – Тип объявления [Фильтр]
- `categories` – [Массив] – **О категории материала**
    - `access2upload` – Группы, имеющие возможность скачивать файлы
    - `url` – [Строка] – Ссылка на категорию материала
    - `access2add` – [Массив] – Права на добавление материалов в категорию
    - `name` – [Строка] – Название категории материала
    - `access2category` – [Массив] – Право на просмотр категории материала
    - `id` – [Число] – ID категории материала
    - `description` – [Строка] – Описание категории материала
- `other4` – [Строка] – Значение поля «Дополнительное поле 4»
- `ontop` – [Строка] – Показывать материал всегда сверху? (`yes`/`no`)
- `includehtml_desc` – [Строка] – Включить HTML-теги для краткого описания материала? (`yes`/`no`)
- `author_phone` – [Строка] – Номер телефона автора объявления
- `author_site` – [Строка] – Ссылка на сайт автора
- `subscribe` – [Строка] – Включена ли подписка на комментарии (уведомления) (`yes`/`no`)
- `other2` – [Строка] – Значение поля «Дополнительное поле 2»
- `pending` – [Строка] – В ожидани ли активации материал? (`yes`/`no`)
- `description_type=(html|bb|plain)` – [Строка] – Краткое описание материала
- `message_type=(html|bb|plain)` – [Строка] – Полное описание материала
- `who_add` – [Строка] – Никнейм пользователя, добавивший материал
- `till_date` – [Строка] – До какого числа объявление активно (timestamp)
- `sort` –
- `title` – [Строка] – Название материала
- `includehtml_msg` – [Строка] – Включить HTML-теги для полного описания материала? (`yes`/`no`)
- `hgu_title` – [Строка] – ЧПУ материала

#### [POST] Добавить тег к материалу

> Обязательные параметры: `id` материала

Обратите внимание, что именно таким образом (с помощью POST-запроса) осуществляется добавление, редактирование и удаление тегов к материалу.

1. Если вам требуется удалить теги, достаточно отправить пустой запрос
1. Если вам требуется отредактировать теги, сделайте полный запрос с теми тегами, которые должны остаться
1. Если требуется добавить новые теги, необходимо ввести список существующих + новые теги

Теги необходимо перечислять через запятую.

Ответ сервера не предполагает возврата данных о материале – только сообщение об операции.

Пример запроса:

    $response = $request->post('/board/tags', array(
        'id' => '1',
        'tags' => 'тег1,тест2'
    ));

Пример ответа:

    {
       "success":{
          "msg":"Данные по тегам материала обновлены"
       }
    }

#### [PUT] Отредактировать материал

> Обязательные параметры: `id` материала

Особенности:

1. Если отсылается запрос с пустым параметром – то это означает удаление значения параметра
1. Если при запросе вы не указали какой-либо параметр – он останется со своим прежним значением

Пример запроса:

    $response = $request->put('/board', array(
        'id' => '188',
        'title' => 'Новое название материала',
        'description_type=bb' => 'Новое краткое описание материала',
        'message_type=html' => 'Новое полное описание материала',
        'author_site' => 'Новый веб-сайт автора',
        'author_email' => 'Новый email автора',
        'author' => 'Новое имя автора',
        'link2source' => 'Новый источник материала',
        'file1' => '@dm.png'
    ));

Пример ответа:

    {
       "end2br_msg":"no",
        "files":[
          {
             "small":"http://yoursite.ucoz.ru/_sf/0/s57172723.jpg",
             "full_height":1200,
             "full_width":1000,
             "small_height":150,
             "small_width":125,
             "full":"http://yoursite.ucoz.ru/_sf/0/57172723.jpg"
          }
       ],
       "author_email":"Новый email автора",
       "author":"Новое имя автора",
       "comments":"yes",
       "end2br_desc":"no",
       "ontop":"no",
       "includehtml_desc":"yes",
       "author_site":"http://Новый веб-сайт автора",
       "subscribe":"no",
       "link2source":"http://Новый источник материала",
       "pending":"no",
       "categories":[
          {
             "access2upload":[
                {
                   "4":"Администраторы"
                }
             ],
             "url":"http://yoursite.ucoz.ru/board/1",
             "access2add":[
                "Все группы"
             ],
             "name":"Мои статьи",
             "access2category":[
                "Все группы"
             ],
             "id":1,
             "description":"test"
          }
       ],
       "description":"Новое краткое описание материала",
       "message":"Новое полное описание материала",
       "who_add":"yoursite",
       "title":"Новое название материала",
       "includehtml_msg":"yes",
       "hgu_title":"nazvanie_materiala"
    }

Расшифровка переменных:

- `other3` – [Строка] – Значение поля «Дополнительное поле 3»
- `file1` – [Файл] – Изображение материала (в случае, если нужно несколько, то file2, file3)
- `end2br_msg` – [Строка] – Статус опции «Заменять теги переноса на `<br />`» для полного описания материала (`yes`/`no`)
- `other5` – [Строка] – Значение поля «Дополнительное поле 5»
- `other1` – [Строка] – Значение поля «Дополнительное поле 1»
- `author_email` – [Строка] – Email автора материала
- `author` – [Строка] – Полное имя автора материала
- `filters` – [Массив] – В какие фильтры входит материал
- `comments` – [Строка] – Позволить оставлять комментарии? (`yes`/`no`)
- `end2br_desc` – [Строка] – Статус опции «Заменять теги переноса на `<br />`» для краткого описания материала (`yes`/`no`)
- `ad_type` – [Строка] – Тип объявления [Фильтр]
- `categories` – [Массив] – **О категории материала**
    - `access2upload` – Группы, имеющие возможность скачивать файлы
    - `url` – [Строка] – Ссылка на категорию материала
    - `access2add` – [Массив] – Права на добавление материалов в категорию
    - `name` – [Строка] – Название категории материала
    - `access2category` – [Массив] – Право на просмотр категории материала
    - `id` – [Число] – ID категории материала
    - `description` – [Строка] – Описание категории материала
- `other4` – [Строка] – Значение поля «Дополнительное поле 4»
- `ontop` – [Строка] – Показывать материал всегда сверху? (`yes`/`no`)
- `includehtml_desc` – [Строка] – Включить HTML-теги для краткого описания материала? (`yes`/`no`)
- `author_phone` – [Строка] – Номер телефона автора объявления
- `author_site` – [Строка] – Ссылка на сайт автора
- `subscribe` – [Строка] – Включена ли подписка на комментарии (уведомления) (`yes`/`no`)
- `other2` – [Строка] – Значение поля «Дополнительное поле 2»
- `pending` – [Строка] – В ожидани ли активации материал? (`yes`/`no`)
- `description_type=(html|bb|plain)` – [Строка] – Краткое описание материала
- `message_type=(html|bb|plain)` – [Строка] – Полное описание материала
- `who_add` – [Строка] – Никнейм пользователя, добавивший материал
- `till_date` – [Строка] – До какого числа объявление активно (timestamp)
- `sort` –
- `title` – [Строка] – Название материала
- `includehtml_msg` – [Строка] – Включить HTML-теги для полного описания материала? (`yes`/`no`)
- `hgu_title` – [Строка] – ЧПУ материала

#### [DELETE] Удалить материал

> Обязательные параметры: `id` материала

Обратите внимание, что удаление материала происходит навсегда, его возврат невозможен.

Ответ сервера не предполагает возврата данных о материале – только сообщение об операции.

Пример запроса:

    $response = $request->delete('/board/posts', array(
        'id' => '1'
    ));

Пример ответа:

    {
       "success":{
          "msg":"Материал удалён"
       }
    }

<a name="module-board-category"></a>
### Категории / Разделы

#### [GET] Все категории/разделы

> Обязательные параметры: отсутствуют

Особенности:

1. Если в модуле есть раздел, а в ней категория (категории), то определить принадлежность к разделу можно будет в массиве "section", который будет внутри категории
1. Несмотря на пункт 1, раздел тоже самостоятелен и он будет дополнительно выведен в ответе как самостоятельный массив

Пример запроса:

    $response = $request->get('/board/category', array(
        // без параметров
    ));

Пример ответа:

    [
       {
          "access2add":[
             "Все группы"
          ],
          "position":"1",
          "name":"Мои статьи",
          "description":"test",
          "access2page":[
             {
                "4":"Администраторы"
             }
          ],
          "entry_count":7,
          "id":1,
          "type":"category",
          "access2category":[
             "Все группы"
          ],
          "hgu_title":null
       },
       {
           // вывод уже другой категории, например, с ID2
       }
    ]

    // Для особенности 1 и 2
    {
      "access2section":[
         "Все группы"
      ],
      "position":"1",
      "name":"Раздел",
      "description":"описание раздела",
      "entry_count":0,
      "id":2,
      "type":"section",
      "hgu_title":"razdel"
   },
   {
     //тут идет вывод информации о категории

      "section":{
         "access2section":[
            "Все группы"
         ],
         "name":"Раздел",
         "id":2,
         "description":"описание раздела",
         "hgu_title":"razdel"
      },

     //продолжение информации о категории
   }

Расшифровка переменных:

- `access2add` – [Массив] – Права на добавление материалов в категорию
- `position` – [Число] – Какой по порядку идет категория
- `name` – [Строка] – Название категории
- `description` – [Строка] – Описание категории
- `access2page` – [Массив] – Группы, имеющие возможность скачивать файлы
- `entry_count` – [Число] – Количество материалов в категории
- `id` – [Число] – ID категории
- `type` – [Строка] – Что это именно (category/section)
access2category или access2section – [Массив] – Какие группы имеют доступ к просмотру категории/раздела
- `hgu_title` – [Строка] – ЧПУ категории

#### [GET] Определенную категорию/раздел

> Обязательные параметры: `id` категории

Пример запроса:

    $response = $request->get('/board/category', array(
        'id' => 'АЙДИКАТЕГОРИИ'
    ));

Особенности:

1. Если у категории нет раздела, то массив `section` будет отсутствовать в ответе
1. Если в запросе указать `id` раздела, то в ответе мы увидим информацию только о разделе (без категорий)
1. Если нужно получить определенный раздел, то в запросе нужно изменить `category` на `section`

Пример ответа:

    [
       {
          "access2add":[
             "Все группы"
          ],
          "position":"2",
          "name":"Категория в разделе",
          "section":{
             "access2section":[
                "Все группы"
             ],
             "name":"Раздел",
             "id":2,
             "description":"описание раздела",
             "hgu_title":"razdel"
          },
          "description":"",
          "access2page":[
             {
                "4":"Администраторы"
             }
          ],
          "entry_count":0,
          "access2category":[
             "Все группы"
          ],
          "id":3,
          "type":"category",
          "hgu_title":"kategorija_v_razdele"
       }
    ]

    //для особенности 2
    [
       {
          "access2section":[
             "Все группы"
          ],
          "position":"1",
          "name":"Раздел",
          "description":"описание раздела",
          "entry_count":0,
          "id":2,
          "type":"section",
          "hgu_title":"razdel"
       }
    ]

Расшифровка переменных:

- `access2add` – [Массив] – Права на добавление материалов в категорию
- `position` – [Число] – Какой по порядку идет категория
- `name` – [Строка] – Название категории
- `section` – [Массив] – Информации о разделе, которой принадлежит категория
- `description` – [Строка] – Описание категории
- `access2page` – [Массив] – Группы, имеющие возможность скачивать файлы
- `entry_count` – [Число] – Количество материалов в категории
- `access2category` или `access2section` – [Массив] – Какие группы имеют доступ к просмотру категории/раздела
- `id` – [Число] – ID категории
- `type` – [Строка] – Что это именно (category/section)
- `hgu_title` – [Строка] – ЧПУ категории

#### [POST] Добавить категорию/раздел

> Обязательные параметры: название категории

Особенности:
1. HGU (ЧПУ) нельзя установить при добавлении категории
1. Если требуется добавить раздел, то в запросе достаточно изменить `category` на `section`

Пример запроса:

    $response = $request->post('/board/category', array(
        'name' => 'Новая категория из АПИ',
        'description' => 'Описание категории из АПИ'
    ));

    // для особенности 2
    $response = $request->post('/board/section', array(
        'name' => 'Новая категория из АПИ',
        'description' => 'Описание категории из АПИ'
    ));

Пример ответа:

    {
       "access2add":[
          {
             "4":"Администраторы"
          }
       ],
       "name":"Новая категория из АПИ",
       "position":4,
       "description":null,
       "access2page":[
          {
             "4":"Администраторы"
          }
       ],
       "entry_count":0,
       "access2category":[
          {
             "4":"Администраторы"
          }
       ],
       "id":5,
       "type":"category",
       "hgu_title":"novaja_kategorija_iz_api"
    }

Расшифровка переменных:

- `access2add` – [Массив] – Права на добавление материалов в категорию
- `name` – [Строка] – Название категории
- `position` – [Число] – Какой по порядку идет категория
- `description` – [Строка] – Описание категории
- `access2page` – [Массив] – Группы, имеющие возможность скачивать файлы
- `entry_count` – [Число] – Количество материалов в категории
- `access2category` или `access2section` – [Массив] – Какие группы имеют доступ к просмотру категории/раздела
- `id` – [Число] – ID категории
- `type` – [Строка] – Что это именно (category/section)
- `hgu_title` – [Строка] – ЧПУ категории

#### [PUT] Отредактировать категорию/раздел

> Обязательные параметры: `id` категории/раздела

Особенности:

1. Если требуется отредактировать раздел, то в запросе достаточно изменить `category` на `section`
1. Невозможно осуществить операцию по превращении раздела в категорию и наоборот
1. Нельзя отредактировать раздел, сделав запрос на `category` и наоборот

Пример запроса:

    $response = $request->put('/board/category', array(
        'id' => '2',
        'name' => 'Категория с новым именем',
        'description' => 'Категория с новым описанием',
        'access2category' => '3,4',
        'hgu_title' => 'newhgu'
    ));

Пример ответа:

    {
       "access2add":[
          "Все группы"
       ],
       "name":"Категория с новым именем",
       "position":1,
       "description":"Категория с новым описанием",
       "access2page":[
          {
             "4":"Администраторы"
          }
       ],
       "entry_count":7,
       "access2category":[
          {
             "3":"Модераторы"
          },
          {
             "4":"Администраторы"
          }
       ],
       "id":1,
       "type":"category",
       "hgu_title":"newhgu"
    }

Расшифровка переменных:

- `access2add` – [Массив] – Права на добавление материалов в категорию
- `name` – [Строка] – Название категории
- `position` – [Число] – Какой по порядку идет категория
- `description` – [Строка] – Описание категории
- `access2page` – [Массив] – Группы, имеющие возможность скачивать файлы
- `entry_count` – [Число] – Количество материалов в категории
- `access2category` или `access2section` – [Массив] – Какие группы имеют доступ к просмотру категории/раздела
- `id` – [Число] – ID категории
- `type` – [Строка] – Что это именно (category/section)
- `hgu_title` – [Строка] – ЧПУ категории

#### [DELETE] Удалить категорию/раздел

> Обязательные параметры: `id` категории/раздела

Особенности:

1. Если требуется удалить раздел, то в запросе достаточно изменить `category` на `section`
1. После удаления категории/раздела – обратное действие по восстановлению невозможно

Пример запроса:

    $response = $request->delete('/board/category', array(
        'id' => '2'
    ));

Пример ответа:

    {
       "success":{
          "msg":"Выполнено"
       }
    }

<a name="module-board-filter"></a>
### Фильтры

#### [GET] Получить фильтр

> Обязательные параметры: отсутствуют

Пример запроса:

    $response = $request->get('/board/filter', array(
        // без параметров
    ));

Пример ответа:

    [
       {
          "filter1":{
             "options":{
                "nomulti2plainusers":"no",
                "multiselect":"yes"
             },
             "name":"Платформа",
             "values":[
                {
                   "value":"Онлайн",
                   "key":1
                },
                {
                   "value":"Мобильные",
                   "key":3
                },
                {
                   "value":"Загружаемые",
                   "key":2
                }
             ]
          },
          "filter2":{
              //информация о фильтре 2
          },
          "filter3":{
              //информация о фильтре 3
          }
       }
    ]

Расшифровка переменных:

- `filter1` – [Массив] – Информация о фильтре
    - `options` – [Массив] – Опции фильтра
        - `nomulti2plainusers` – [Строка] – Множественный выбор значений для обычных пользователей (`yes`/`no`)
        - `multiselect` – [Строка] – Множественный выбор значений (`yes`/`no`)
    - `name` – [Строка] – Название фильтра
    - `values` – [Массив] – Значения фильтра
        - `value` – [Строка] – Значение фильтра
        - `key` – [Число] – Уникальный ключ (подобие ID) значения

#### [GET] Определенный фильтр

> Обязательные параметры: `id` фильтра

Пример запроса:

    $response = $request->get('/board/filter', array(
        'filter_id' => '1'
    ));

Пример ответа:

    [
       {
          "filter1":{
             "options":{
                "nomulti2plainusers":"no",
                "multiselect":"yes"
             },
             "name":"Платформа",
             "values":[
                {
                   "value":"Онлайн",
                   "key":1
                },
                {
                   "value":"Мобильные",
                   "key":3
                },
                {
                   "value":"Загружаемые",
                   "key":2
                }
             ]
          }
       }
    ]

Расшифровка переменных:

- `filter1` – [Массив] – Информация о фильтре
    - `options` – [Массив] – Опции фильтра
        - `nomulti2plainusers` – [Строка] – Множественный выбор значений для обычных пользователей (`yes`/`no`)
        - `multiselect` – [Строка] – Множественный выбор значений (`yes`/`no`)
    - `name` – [Строка] – Название фильтра
    - `values` – [Массив] – Значения фильтра
        - `value` – [Строка] – Значение фильтра
        - `key` – [Число] – Уникальный ключ (подобие ID) значения

#### [POST] Добавить фильтр

> Обязательные параметры: `filter_num`, `name`, `items`

Особенности:

1. Перечисление значений фильтра осуществляется через | (например: uCoz.ru | uAPI | uID.me)

Пример запроса:

    $response = $request->post('/board/filter', array(
        'filter_num' => '1',
        'name' => 'Название из API',
        'items' => 'Значение1 | Значение2 | Значение3'
    ));

Возможные параметры для передачи:

- `filter_num` – [Строка] – Порядковый номер фильтра (возможные варианты: 1, 2, 3)
- `name` – [Строка] – Название фильтра
- `items` – [Строка] – Значения фильтра
- `multi` – [Строка] – Множественный выбор значений (`yes`/`no`)
- `nomulti` – [Строка] – Множественный выбор значений для обычных пользователей (`yes`/`no`)

Пример ответа:

    {
       "success":{
          "msg":"Фильтр создан/отредактирован"
       }
    }

#### [PUT] Редактор фильтра

> Обязательные параметры: `filter_num` (номер фильтра)

Особенности:

1. Перечисление значений фильтра осуществляется через | (например: uCoz.ru | uAPI | uID.me)

Пример запроса:

    $response = $request->put('/board/filter', array(
        'filter_num' => '1',
        'name' => 'Новое название из API',
        'items' => 'Новое Значение1 | Новое Значение2 | Новое Значение3'
    ));

Пример ответа:

    {
       "success":{
          "msg":"Фильтр создан/отредактирован"
       }
    }

Расшифровка переменных:

- `filter_num` – [Строка] – Порядковый номер фильтра (возможные варианты: 1, 2, 3)
- `name` – [Строка] – Название фильтра
- `items` – [Строка] – Значения фильтра
- `multi` – [Строка] – Множественный выбор значений (`yes`/`no`)
- `nomulti` – [Строка] – Множественный выбор значений для обычных пользователей (`yes`/`no`)

#### [DELETE] Удалить фильтр

> Обязательные параметры: `filter_num` (номер фильтра)

Особенности:

- `filter_num` – [Строка] – Порядковый номер фильтра (возможные варианты: 1, 2, 3)

Пример запроса:

    $response = $request->delete('/board/filter', array(
        'filter_num' => '1'
    ));

Пример ответа:

    {
       "success":{
          "msg":"Фильтр удалён"
       }
    }

<a name="module-board-comments"></a>
### Комментарии

#### [GET] Комментарии материала

> Обязательные параметры: `id` материала

Особенности:

1. Если комментарий является родительским, то внутри массива `messages` добавится еще один массив `messages` (массив внутри массива). Отличительной чертой будет являться переменная `parent_id`

Пример запроса:

    $response = $request->get('/board/comments', array(
        'id' => 'АЙДМАТЕРИАЛА'
    ));

Пример ответа:

    {
       "messages":[
          {
             "www":"",
             "answer":"",
             "avatar":"http://2093175133.uid.me/avatar.jpg",
             "author":"Dmitry",
             "pending":"no",
             "full_name":"Dmitry Kiselev",
             "message":"Мой комментарий",
             "rate":0,
             "add_date":"2015-01-16 02:06",
             "email":"",
             "rateuids":"",
             "id":34
          }, {
              //другой комментарий
          }
       ],
       "page":1,
       "pages":[
          1
       ],
       "per_page":10,
       "id":189,
       "total_msg":1
    }

    // Для особенности 1
    {
       "messages":[
          {
             "messages":[
                {
                    //информация о родительском комментарии
                   "parent_id":"34",
                   //продолжается информация о родительском комментарии
                }
             ],
             //информация о комментарии главном родителе
          },
       ],
       //информации о материале, откуда запрошен комментарий
    }

Расшифровка переменных:

- `messages` – [Массив] – **Первый полученный комментарий**
    - `www` – [Строка] – Поле "WWW"
    - `answer` – [Строка] – Ответ для комментария
    - `avatar` – [Строка] – Ссылка на аватар пользователя, оставившего комментарий
    - `author` – [Строка] – Никнейм пользователя, оставившего комментарий
    - `pending` – [Строка] – Комментарий в ожидании модерации? (`yes`/`no`)
    - `full_name` – [Строка] – Полное имя, добавившего комментарий
    - `message` – [Строка] – Текст комментария
    - `rate` – [Число] – Текущий рейтинг комментария
    - `add_date` – [Строка] – Дата добавления комментария
    - `email` – [Строка] – Поле "Email"
    - `rateuids` – [Строка] –
    - `id` – [Число] – ID добавленного комментария
    - `parent_id` – [Число] – Если комментарий родительский, выводит ID родителя
- `page` – [Число] – Количество страниц комментариев
- `pages_list` – [Массив] – Возможные страницы в переключателе комментариев
- `per_page` – [Число] – Количество комментариев на 1 страницу
- `id` – [Число] – ID материала, откуда были запрошены комментарии
- `total_msg` – [Число] – Общее количество комментариев к материалу

#### [POST] Добавить комментарий

> Обязательные параметры: `id` материала, текст комментария

Пример запроса:

    $response = $request->post('/board/comments', array(
        'entry_id' => '189',
        'message' => 'Комментарий из API'
    ));

Пример ответа:

    {
       "add_date":"2015-01-16 02:35",
       "entry_link":"http://yoursite.ucoz.ru/board/3-1-0-189",
       "pending":"no",
       "author":"Dmitry",
       "full_name":null,
       "entry_id":38,
       "message":"Комментарий из API"
    }

Расшифровка переменных:

- `add_date` – [Строка] – Дата добавления комментария
- `entry_link` – [Строка] – Ссылка на страницу материала, куда был добавлен комментарий
- `pending` – [Строка] – Комментарий в ожидании модерации? (`yes`/`no`)
- `author` – [Строка] – Никнейм пользователя, оставившего комментарий
- `full_name` – [Строка] – Полное имя, добавившего комментарий
- `entry_id` – [Число] – ID материала, где был добавлен комментарий
- `message` – [Строка] – Текст комментария

#### [PUT] Редактор комментария

> Обязательные параметры: `id` категории / раздела

Особенности:

1. Из родительского комментария нельзя сделать главный комментарий (то есть конвертация или удаление вложенности невозможно)

Пример запроса:

    $response = $request->put('/board/comments', array(
        'id' => '36',
        'message' => 'Комментарий из API'
    ));

Пример ответа:

    {
       "add_date":"2015-01-16 02:20",
       "who_add":"uapitest003",
       "author":"uapitest003 uapitest003",
       "pending":"no",
       "id":36,
       "message":"Комментарий из API"
    }

Расшифровка переменных:

- `add_date` – [Строка] – Дата добавления комментария
- `who_add` – [Строка] – Никнейм пользователя, оставившего комментарий
- `author` – [Строка] – Никнейм пользователя, оставившего комментарий
- `pending` – [Строка] – Комментарий в ожидании модерации? (`yes`/`no`)
- `id` – [Число] – ID добавленного комментария

#### [DELETE] Удалить комментарий

> Обязательные параметры: `id` комментария

Особенности:

1. Отменить действие «Удалить» невозможно
1. Если у комментария есть родительские комментарии – они удалены автоматически не будут, дерево комментариев перестроится

Пример запроса:

    $response = $request->delete('/board/comments', array(
        'id' => '2'
    ));

Пример ответа:

    {
       "success":{
          "msg":"Сообщение удалено"
       }
    }

<a name="module-board-fields"></a>
### Настройки полей

#### [GET] Настройки полей модуля

> Обязательные параметры: отсутствуют.
>
> Запрос показывает, какие поля доступны при добавлении и редактировании материала.

Особенности:

1. Ответ строится исходя из настроек в Панели управления: Доска объявлений -> Настройки модуля -> Поля для добавления материалов

Пример запроса:

    $response = $request->get('/board/fields', array(
        // без параметров
    ));

Пример ответа:

    [
       {
          "checked":"yes",
          "required":"no",
          "name":"Разместить до"
       },
       {
          "checked":"yes",
          "required":"no",
          "name":"Контактное лицо"
       },
       {
          "checked":"yes",
          "required":"no",
          "name":"Тема объявления"
       },
       {
          "checked":"yes",
          "required":"yes",
          "name":"Тип объявления"
       },
       {
          "checked":"no",
          "required":"no",
          "name":"Дополнительное поле 5"
       },
       {
          "checked":"no",
          "required":"no",
          "name":"Дополнительное поле 2"
       },
       {
          "checked":"no",
          "required":"no",
          "name":"Файл-архив"
       },
       {
          "checked":"yes",
          "required":"no",
          "name":"Текст объявления"
       },
       {
          "checked":"yes",
          "required":"no",
          "name":"Web-site"
       },
       {
          "checked":"no",
          "required":"no",
          "name":"Дополнительное поле 1"
       },
       {
          "checked":"no",
          "required":"no",
          "name":"Изображения"
       },
       {
          "checked":"no",
          "required":"no",
          "name":"Дополнительное поле 3"
       },
       {
          "checked":"no",
          "required":"no",
          "name":"Дополнительное поле 4"
       },
       {
          "checked":"yes",
          "required":"no",
          "name":"E-mail"
       },
       {
          "checked":"no",
          "required":"no",
          "name":"Полный текст материала"
       },
       {
          "checked":"no",
          "required":"no",
          "name":"Извещения о комментариях"
       },
       {
          "checked":"yes",
          "required":"no",
          "name":"Телефон"
       },
       {
          "checked":"yes",
          "required":"no",
          "name":"Скриншот"
       }
    ]

Расшифровка переменных ответа:

- `checked` – [Строка] – Доступно ли поле при добавлении/редактировании материала? (`yes`/`no`)
- `required` – [Строка] – Является ли поле при добавлении/редактировании материала обязательным? (`yes`/`no`)
- `name` – [Строка] – Название поля
