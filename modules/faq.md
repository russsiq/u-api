# uAPI модуля «FAQ (вопросы/ответы)»

- [Материалы](#module-faq-entry)
- [Категории](#module-faq-category)
- [Настройки полей](#module-faq-fields)

<a name="module-faq-entry"></a>
### Материалы

#### [GET] Получить вопросы

> Обязательные параметры: отсутствуют

Пример запроса:

    $response = $request->get('/faq', array(
        // без параметров
    ));

Пример ответа:

    {
       "total_faqs":1,
       "faqs":[
          {
             "answer":"newone3",
             "subject":"newone",
             "rate_num":0,
             "pending":"no",
             "author_email":"",
             "author":"",
             "description":"newone2",
             "rating":"0.00",
             "who_add":"Dmitry",
             "rate_sum":0,
             "sort":0,
             "category":{
                "faqs_count":"1",
                "name":"Катгория1",
                "url":"http://yoursite.ucoz.ru/faq/1-1",
                "id":1,
                "description":null,
                "hgu_title":null
             },
             "id":3,
             "hgu_title":"newone"
          },
          {
              //идет вопрос, например, с ID4
          },
          {
              //идет вопрос, например, с ID5
          }

       ]
    }

Расшифровка переменных:

- `total_faqs` – [Число] – Общее количество вопросов в модуле
    - `faqs` – [Массив] – Вопросы в модуле
        - `answer` – [Строка] – Ответ на вопрос
        - `subject` – [Строка] – Тема вопроса
        - `rate_num` – [Число] – Количество голосов (рейтинг)
        - `pending` – [Строка] – В ожидани ли активации материал? (yes/no)
        - `author_email` – [Строка] – Email автора материала
        - `author` – [Строка] – Полное имя автора материала
        - `description_type`=(html|bb|plain) – [Строка] – Краткое описание материала
        - `rating` – [Число] – Рейтинг материала (Общая сумма рейтинга/на количество голосов)
        - `who_add` – [Строка] – Никнейм пользователя, добавивший материал
        - `rate_sum` – [Число] – Общая сумма рейтинга
        - `sort` –
        - `category` – [Массив] – О категории
            - `faqs_count` – [Строка] – Общее количество вопросов в категории
            - `name` – [Строка] – Название категории
            - `url` – [Строка] – Ссылка на категорию материала
            - `id` – [Число] – ID категории материала
            - `description` – [Строка] – Описание категории материала
            - `hgu_title` – [Строка] – ЧПУ категории
        - `id` – [Число] – ID полученного материала
        - `hgu_title` – [Строка] – ЧПУ материала

#### [POST] Добавить вопрос

> Обязательные параметры: зависит от настроек модуля

Пример запроса:

    $response = $request->post('/faq', array(
        'question' => 'Мой вопрос из API',
        'subject' => 'Название вопроса'
    ));

Пример ответа:

    {
       "includehtml_desc":"yes",
       "end2br_msg":"no",
       "answer":null,
       "subject":"Название вопроса",
       "pending":"no",
       "author_email":null,
       "author":null,
       "description":null,
       "who_add":"Dmitry",
       "add_date":"2015-01-20 03:38",
       "sort":0,
       "end2br_desc":"no",
       "includehtml_msg":"yes",
       "hgu_title":"nazvanie_voprosa"
    }

Расшифровка переменных:

- `includehtml_desc` – [Строка] – Включить HTML-теги для краткого описания материала? (yes/no)
- `end2br_msg` – [Строка] – Статус опции «Заменять теги переноса на `<br />`» для полного описания материала (yes/no)
- `answer` – [Строка] – Ответ на вопрос
- `subject` – [Строка] – Тема вопроса
- `pending` – [Строка] – В ожидани ли активации материал? (yes/no)
- `author_email` – [Строка] – Email автора материала
- `author` – [Строка] – Полное имя автора материала
- `description_type`=(html|bb|plain) – [Строка] – Краткое описание материала
- `who_add` – [Строка] – Никнейм пользователя, добавивший материал
- `add_date` – [Строка] – Время добавления материала
- `sort` –
- `end2br_desc` – [Строка] – Статус опции «Заменять теги переноса на `<br />`» для краткого описания материала (yes/no)
- `includehtml_msg` – [Строка] – Включить HTML-теги для полного описания материала? (yes/no)
- `hgu_title` – [Строка] – ЧПУ материала

#### [PUT] Редактор вопроса

> Обязательные параметры: `id`

Пример запроса:

    $response = $request->put('/faq', array(
        'id' => '3',
        'question' => 'Изменил вопрос по API',
        'subject' => 'Измененное название'
    ));

Пример ответа:

    {
       "includehtml_desc":"yes",
       "end2br_msg":"no",
       "answer":"newone3",
       "subject":"Измененное название",
       "pending":"no",
       "author_email":"",
       "author":"",
       "description":"newone2",
       "add_date":"2015-01-20 03:45",
       "sort":0,
       "end2br_desc":"no",
       "category":{
          "faqs_count":"1",
          "name":"Катгория1",
          "url":"http://yoursite.ucoz.ru/faq/1-1",
          "id":1,
          "description":"\n",
          "hgu_title":null
       },
       "includehtml_msg":"yes",
       "hgu_title":"newone"
    }

Расшифровка переменных:

- `includehtml_desc` – [Строка] – Включить HTML-теги для краткого описания материала? (yes/no)
- `end2br_msg` – [Строка] – Статус опции «Заменять теги переноса на `<br />`» для полного описания материала (yes/no)
- `answer` – [Строка] – Ответ на вопрос
- `subject` – [Строка] – Тема вопроса
- `pending` – [Строка] – В ожидани ли активации материал? (yes/no)
- `author_email` – [Строка] – Email автора материала
- `author` – [Строка] – Полное имя автора материала
- `description_type`=(html|bb|plain) – [Строка] – Краткое описание материала
- `who_add` – [Строка] – Никнейм пользователя, добавивший материал
- `sort` –
- `end2br_desc` – [Строка] – Статус опции «Заменять теги переноса на `<br />`» для краткого описания материала (yes/no)
- `category` – [Массив] – О категории
    - `faqs_count` – [Строка] – Общее количество вопросов в категории
    - `name` – [Строка] – Название категории материала
    - `url` – [Строка] – Ссылка на категорию материала
    - `id` – [Число] – ID категории материала
    - `description` – [Строка] – Описание категории материала
    - `hgu_title` – [Строка] – ЧПУ категории
- `includehtml_msg` – [Строка] – Включить HTML-теги для полного описания материала? (yes/no)
- `hgu_title` – [Строка] – ЧПУ материала

#### [DELETE] Удаление вопроса

> Обязательные параметры: `id`

Пример запроса:

    $response = $request->delete('/faq/question', array(
        'id' => '1'
    ));

Пример ответа:

    {
       "success":{
          "msg":"Материал удалён"
       }
    }

#### [GET] Получить теги вопросов

> Обязательные параметры: `id` материала

Пример запроса:

    $response = $request->get('/faq/tags', array(
        // без параметров
    ));

Пример ответа:

    {
       "tags":[
          "тег1",
          "тег2",
          "тег3"
       ]
    }

<a name="module-faq-category"></a>
### Категории

#### [GET] Все категории

> Обязательные параметры: отсутствуют

Пример запроса:

    $response = $request->get('/faq/category', array(
       // без параметров
    ));

Пример ответа:

    [
       {
          "access2add":[
             "Все группы"
          ],
          "position":"1",
          "name":"Катгория1",
          "description":null,
          "access2page":[
             "Все группы"
          ],
          "entry_count":1,
          "id":1,
          "type":"category",
          "access2category":[
             "Все группы"
          ],
          "hgu_title":null
       }
    ]

Расшифровка переменных:

- `access2add` – [Массив] – Права на добавление материалов в категорию
- `position` – [Число] – Какой по порядку идет категория
- `name` – [Строка] – Название категории
- `description` – [Строка] – Описание категории
- `access2page` – [Массив] – Группы, имеющие возможность скачивать файлы
- `entry_count` – [Число] – Количество материалов в категории
- `id` – [Число] – ID категории
- `type` – [Строка] – Что это именно (category/section)
- `access2category` или access2section – [Массив] – Какие группы имеют доступ к просмотру категории/раздела
- `hgu_title` – [Строка] – ЧПУ категории [GET] Определенную категорию

#### [GET] Определенную категорию

> Обязательный параметр: ID (айди категории)

Пример запроса:

    $response = $request->get('/faq/category', array(
       'id' => 'АЙДИКАТЕГОРИИ'
    ));

Пример ответа:

    // Отсутствует в документации

Расшифровка переменных:

- `access2add` – [Массив] – Права на добавление материалов в категорию
- `position` – [Число] – Какой по порядку идет категория
- `name` – [Строка] – Название категории
- `description` – [Строка] – Описание категории
- `access2page` – [Массив] – Группы, имеющие возможность скачивать файлы
- `entry_count` – [Число] – Количество материалов в категории
- `id` – [Число] – ID категории
- `type` – [Строка] – Что это именно (category/section)
- `access2category` или access2section – [Массив] – Какие группы имеют доступ к просмотру категории/раздела
- `hgu_title` – [Строка] – ЧПУ категории

#### [POST] Добавить категорию

> Обязательные параметры: название категории

Особенности:

1. HGU (ЧПУ) нельзя установить при добавлении категории
1. Если требуется добавить раздел, то в запросе достаточно изменить `category` на `section`

Пример запроса:

    $response = $request->post('/faq/category', array(
        'name' => 'Новая категория из АПИ',
        'description' => 'Описание категории из АПИ'
    ));

    // для особенности 2
    $response = $request->post('/faq/section', array(
        'name' => 'Новая категория из АПИ',
        'description' => 'Описание категории из АПИ'
    ));

Пример ответа:

    {
       "access2add":[
          {
             "4":"Администраторы"
          }
       ],
       "name":"Новая категория из АПИ",
       "position":4,
       "description":null,
       "access2page":[
          {
             "4":"Администраторы"
          }
       ],
       "entry_count":0,
       "access2category":[
          {
             "4":"Администраторы"
          }
       ],
       "id":5,
       "type":"category",
       "hgu_title":"novaja_kategorija_iz_api"
    }

Расшифровка переменных:

- `access2add` – [Массив] – Права на добавление материалов в категорию
- `name` – [Строка] – Название категории
- `position` – [Число] – Какой по порядку идет категория
- `description` – [Строка] – Описание категории
- `access2page` – [Массив] – Группы, имеющие возможность скачивать файлы
- `entry_count` – [Число] – Количество материалов в категории
- `access2category` или access2section – [Массив] – Какие группы имеют доступ к просмотру категории/раздела
- `id` – [Число] – ID категории
- `type` – [Строка] – Что это именно (category/section)
- `hgu_title` – [Строка] – ЧПУ категории

#### [PUT] Редактор категории

> Обязательные параметры: ID категории/раздела

Особенности:

1. Если требуется отредактировать раздел, то в запросе достаточно изменить `category` на `section`
1. Невозможно осуществить операцию по превращении раздела в категорию и наоборот
1. Нельзя отредактировать раздел, сделав запрос на `category` и наоборот

Пример запроса:

    $response = $request->put('/faq/category', array(
        'id' => '2',
        'name' => 'Категория с новым именем',
        'description' => 'Категория с новым описанием',
        'access2category' => '3,4',
        'hgu_title' => 'newhgu'
    ));

Пример ответа:

    {
       "access2add":[
          "Все группы"
       ],
       "name":"Категория с новым именем",
       "position":1,
       "description":"Категория с новым описанием",
       "access2page":[
          {
             "4":"Администраторы"
          }
       ],
       "entry_count":7,
       "access2category":[
          {
             "3":"Модераторы"
          },
          {
             "4":"Администраторы"
          }
       ],
       "id":1,
       "type":"category",
       "hgu_title":"newhgu"
    }

Расшифровка переменных:

- `access2add` – [Массив] – Права на добавление материалов в категорию
- `name` – [Строка] – Название категории
- `position` – [Число] – Какой по порядку идет категория
- `description` – [Строка] – Описание категории
- `access2page` – [Массив] – Группы, имеющие возможность скачивать файлы
- `entry_count` – [Число] – Количество материалов в категории
- `access2category` или access2section – [Массив] – Какие группы имеют доступ к просмотру категории/раздела
- `id` – [Число] – ID категории
- `type` – [Строка] – Что это именно (category/section)
- `hgu_title` – [Строка] – ЧПУ категории

#### [DELETE] Удалить категорию

> Обязательные параметры: ID категории/раздела

Особенности:

1. Если требуется удалить раздел, то в запросе достаточно изменить `category` на `section`
1. После удаления категории/раздела – обратное действие по восстановлению невозможно

Пример запроса:

    $response = $request->delete('/faq/category', array(
        'id' => '2'
    ));

Пример ответа:

    {
       "success":{
          "msg":"Выполнено"
       }
    }

<a name="module-faq-fields"></a>
### Настройки полей

#### [GET] Настройки полей модуля

> Обязательные параметры: отсутствуют.
>
> Запрос показывает, какие поля доступны при добавлении и редактировании материала

Особенности:

1. Ответ строится исходя из настроек в Панели управления: FAQ (вопросы-ответы) –> Настройки модуля –> Поля для добавления материалов

Пример запроса:

    $response = $request->get('/faq/fields', array(
        // без параметров
    ));

Пример ответа:

    [
       {
          "checked":"yes",
          "required":"no",
          "name":"E-mail адрес"
       },
       {
          "checked":"yes",
          "required":"yes",
          "name":"Тема вопроса"
       },
       {
          "checked":"yes",
          "required":"no",
          "name":"Полное имя"
       },
       {
          "checked":"no",
          "required":"no",
          "name":"Описание вопроса"
       },
       {
          "checked":"yes",
          "required":"no",
          "name":"Изображения"
       }
    ]

Расшифровка переменных:

- `checked` – [Строка] – Доступно ли поле при добавлении/редактировании материала? (yes/no)
- `required` – [Строка] – Является ли поле при добавлении/редактировании материала обязательным? (yes/no)
- `name` – [Строка] – Название поля
