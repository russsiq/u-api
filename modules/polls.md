# uAPI модуля «Опросы»

#### [GET] Все опросы

> Обязательные параметры: отсутствуют

Пример запроса:

    $response = $request->get('/polls', array(
        // без параметров
    ));

Пример ответа:

    [
       {
          "question":"Оцените мой сайт",
          "access2vote":[
             "Все группы"
          ],
          "form_type":"Radio",
          "button_caption":"Оценить",
          "id":1,
          "votes_sum":1,
          "start_date":"01-01-2005",
          "answers":[
             {
                "Отлично":0
             },
             {
                "Хорошо":1
             },
             {
                "Неплохо":0
             },
             {
                "Плохо":0
             },
             {
                "Ужасно":0
             }
          ]
       },
       {
           //вывод второго опроса
       },
       {
           //вывод третьего опроса
       },
    ]

Расшифровка переменных:

- `question` – [Строка] – Вопрос
- `access2vote` – [Массив] – Группы, которые имеют право голосовать в этом опросе
- `form_type` – [Строка] – Тип формы опроса (`Radio`, `Checkbox`, `Select`, `Select (multiple)`, `Links`)
- `button_caption` – [Строка] – Надпись на кнопке
- `id` – [Строка] – ID опроса
- `votes_sum` – [Строка] – Общее количество голосов
- `start_date` – [Строка] – Дата старта опроса
- `answers` – [Массив] – Варианты ответа (Ответ – кол-во проголосовавших за этот ответ)

#### [GET] Определенный опрос

> Обязательные параметры: `id`

Пример запроса:

    $response = $request->get('/polls', array(
       'id' => 'АЙДИОПРОСА'
    ));

Пример ответа:

    [
       {
          "question":"Оцените мой сайт",
          "access2vote":[
             "Все группы"
          ],
          "form_type":"Radio",
          "button_caption":"Оценить",
          "id":1,
          "votes_sum":1,
          "start_date":"01-01-2005",
          "answers":[
             {
                "Отлично":0
             },
             {
                "Хорошо":1
             },
             {
                "Неплохо":0
             },
             {
                "Плохо":0
             },
             {
                "Ужасно":0
             }
          ]
       }
    ]

Расшифровка переменных:

- `question` – [Строка] – Вопрос
- `access2vote` – [Массив] – Группы, которые имеют право голосовать в этом опросе
- `form_type` – [Строка] – Тип формы опроса (`Radio`, `Checkbox`, `Select`, `Select (multiple)`, `Links`)
- `button_caption` – [Строка] – Надпись на кнопке
- `id` – [Строка] – ID опроса
- `votes_sum` – [Строка] – Общее количество голосов
- `start_date` – [Строка] – Дата старта опроса
- `answers` – [Массив] – Варианты ответа (Ответ – кол-во проголосовавших за этот ответ)

#### [POST] Добавить опрос

> Обязательные параметры: `question`, `answer1`

Пример запроса:

    $response = $request->post('/polls', array(
        'question' => 'Новый вопрос из API',
        'answer1' => 'Первый ответ',
        'answer2' => 'Второй ответ',
        'form_type' => '2' // 1 – Radio, 2 – Checkbox, 3 – Select, 4 – Select (multiple), 5 – Links
    ));

Пример ответа:

    {
       "active":"yes",
       "question":"Новый вопрос из API",
       "access2vote":[
          "Все группы"
       ],
       "button_caption":"Ответить",
       "votes_sum":"0",
       "form_type":"Checkbox",
       "start_date":"2015-01-21",
       "answers":[
          {
             "Первый ответ":0
          },
          {
             "Второй ответ":0
          }
       ],
       "CODE_VAR":"$POLLC_9$"
    }

Расшифровка переменных:

- `active` – [Строка] – Активен ли опрос в данный момент (`yes`/`no`)
- `question` – [Строка] – Вопрос
- `access2vote` – [Массив] – Группы, которые имеют право голосовать в этом опросе
- `button_caption` – [Строка] – Надпись на кнопке
- `votes_sum` – [Строка] – Общее количество голосов
- `form_type` – [Строка] – Тип формы опроса (`Radio`, `Checkbox`, `Select`, `Select (multiple)`, `Links`)
- `start_date` – [Строка] – Дата старта опроса
- `answers` – [Массив] – Варианты ответа (Ответ – кол-во проголосовавших за этот ответ)
- `CODE_VAR` – [Строка] – `u`-переменная для вывода на сайте (прописывается в Управлении дизайном)

#### [PUT] Редактор опроса

> Обязательные параметры: `id`

Пример запроса:

    $response = $request->put('/polls', array(
        'id' => '3',
        'question' => 'Измененный вопрос из API',
        'answer1' => 'Измененный первый ответ',
        'answer2' => 'Измененный второй ответ'
    ));

Пример ответа:

    {
       "active":"yes",
       "question":"Измененный вопрос из API",
       "access2vote":[
          "Все группы"
       ],
       "button_caption":"Ответить",
       "votes_sum":"6",
       "form_type":"Radio",
       "start_date":"2014-11-26",
       "answers":[
          {
             "Измененный первый ответ":6
          },
          {
             "Измененный второй ответ":0
          }
       ],
       "CODE_VAR":"$POLLC_3$"
    }

Расшифровка переменных:

- `active` – [Строка] – Активен ли опрос в данный момент (`yes`/`no`)
- `question` – [Строка] – Вопрос
- `access2vote` – [Массив] – Группы, которые имеют право голосовать в этом опросе
- `button_caption` – [Строка] – Надпись на кнопке
- `votes_sum` – [Строка] – Общее количество голосов
- `form_type` – [Строка] – Тип формы опроса (`Radio`, `Checkbox`, `Select`, `Select (multiple)`, `Links`)
- `start_date` – [Строка] – Дата старта опроса
- `answers` – [Массив] – Варианты ответа (Ответ – кол-во проголосовавших за этот ответ)
- `CODE_VAR` – [Строка] – `u`-переменная для вывода на сайте (прописывается в Управлении дизайном)

#### [DELETE] Удалить опрос

> Обязательные параметры: `id`

Пример запроса:

    $response = $request->delete('/polls', array(
        'id' => '3'
    ));

Пример ответа:

    {
       "success":{
          "msg":"Изменения сохранены"
       }
    }
